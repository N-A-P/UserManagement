<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mockproject.du1.mapper.EmailTemplateMapper">


    <!--Get List Data User Information -->
    <resultMap id="GetEmailResultMap"
               type="com.mockproject.du1.model.EmailTemplate">
		<id column="id" property="id" jdbcType="BIGINT" />
		<result column="title" property="title" jdbcType="VARCHAR" />
		<result column="body" property="body" jdbcType="VARCHAR" />
		<result column="updated_by" property="updatedBy" jdbcType="VARCHAR" />
		<result column="created_timestamp" property="createdTimestamp" jdbcType="TIMESTAMP" />
		<result column="updated_timestamp" property="updatedTimestamp" jdbcType="TIMESTAMP" />
    </resultMap>

	<sql id="Base_Column_List" >
		<!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Nov 05 09:04:05 ICT 2019.
        -->
		id, title, body, updated_by, created_timestamp, updated_timestamp
	</sql>
    <insert id="sqlCreateEmailInsert" parameterType="com.mockproject.du1.model.EmailTemplate">
        <selectKey keyProperty="id" resultType="int">
            SELECT currval('"email_template_id_seq"')
        </selectKey>
		insert into email_template (title, body, updated_by,
		created_timestamp, updated_timestamp)
		values (#{title,jdbcType=VARCHAR}, #{body,jdbcType=VARCHAR}, #{updatedBy,jdbcType=VARCHAR},
		#{createdTimestamp,jdbcType=TIMESTAMP}, #{updatedTimestamp,jdbcType=TIMESTAMP})
    </insert>

    <select id="sqlGetAllEmailTemplateSelect"
            resultMap="GetEmailResultMap">
		select
		<include refid="Base_Column_List" />
		from email_template
	</select>

    <select id="sqlGetEmailSelectById"
            resultMap="GetEmailResultMap" parameterType="INT">
		select
		<include refid="Base_Column_List" />
		from email_template
		where id = #{id,jdbcType=BIGINT}
	</select>
    <update id="sqlEmailUpdate">
		update email_template
		<set >
			<if test="title != null" >
				title = #{title,jdbcType=VARCHAR},
			</if>
			<if test="body != null" >
				body = #{body,jdbcType=VARCHAR},
			</if>
			<if test="updatedBy != null" >
				updated_by = #{updatedBy,jdbcType=VARCHAR},
			</if>
			<if test="createdTimestamp != null" >
				created_timestamp = #{createdTimestamp,jdbcType=TIMESTAMP},
			</if>
			<if test="updatedTimestamp != null" >
				updated_timestamp = #{updatedTimestamp,jdbcType=TIMESTAMP},
			</if>
		</set>
		where id = #{id,jdbcType=BIGINT}
	</update>
    <select id="sqlGetEmailTemplateSelectByCampaintId"
            resultMap="GetEmailResultMap" parameterType="INT">
		SELECT
	    b.id,
	    b.title,
	    b.body,
	    b.created_timestamp,
	    b.updated_by,
	    b.updated_timestamp
		FROM
		public.campaign a inner join public.email_template b
		on
		a.email_template_id=b.id
        WHERE
		a.id = #{id}
	</select>

</mapper>